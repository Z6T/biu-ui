<template>
    <div class="nt-table" ref="ntTableWrapper">
        <div class="nt-table__scroll" ref="scrolWrapper">
            <table class="nt-table__scroll__table" ref="scrollTable">
                <thead ref="scrolThead">
                    <tr>
                        <th>shdfsdfg</th>
                        <th>clickme</th>
                        <th>clickme</th>
                        <th>clickme</th>
                        <th>jkhjkhhjhjkjhkhjkhjkjkhjkhhjk</th>
                        <th>clickme</th>
                        <th>clickme</th>
                        <th>clickme</th>
                        <th>clickme</th>
                        <th>mm</th>
                    </tr>
                </thead>

                <tbody>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="nt-table__fixedleft" ref="fixedleftWrapper">
            <table class="nt-table__fixedleft__table" ref="fixedleftTable">
                <thead ref="fixedleftThead" style="transform:translateY(0px)">
                    <tr>
                        <th>shdfsdfg</th>
                        <th>clickme</th>
                    </tr>
                </thead>

                <tbody ref="fixedleft_tbody">
                    <tr>
                        <td>xxx</td>
                        <td>xxx</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>yy</td>
                        <td>yyy</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="nt-table__fixedright" ref="fixedrightWrapper">
            <table class="nt-table__fixedright__table" ref="fixedrightTable">
                <thead ref="fixedrightThead" style="transform:translateY(0px)">
                    <tr>
                        <th>shdfsdfg</th>
                        <th>clickme</th>
                    </tr>
                </thead>

                <tbody ref="fixedright_tbody">
                    <tr>
                        <td>xxx</td>
                        <td>xxx</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>hoverme</td>
                        <td>hoverme</td>
                    </tr>
                    <tr>
                        <td>yy</td>
                        <td>yyy</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</template>

<script>
export default {
    name: 'nt-table',
    mounted() {
        console.log('this.$refs.scrollWrapper :', this.$refs);
        const _this = this;
        this.$refs.scrolWrapper.addEventListener('scroll', function (e) {
            const { scrollTop, scrollLeft } = e.target;
            console.log(scrollTop, scrollLeft, e);
            // _this.$refs.scrolThead.style.transform = `translateY(${scrollTop}px)`
            // _this.$refs.fixedleftTable.style.transform = `translateY(-${scrollTop}px)`
            // _this.$refs.fixedleftThead.style.transform = `translateY(${scrollTop}px)`
        })
        this.$refs.ntTableWrapper.addEventListener('scroll', function (e) {
            const { scrollTop, scrollLeft, scrollWidth } = e.target;
            _this.$refs.scrolThead.style.transform = `translateY(${scrollTop}px)`
            if (scrollLeft) {
                _this.$refs.fixedleftWrapper.classList.add('fix-shadow')
            } else {
                _this.$refs.fixedleftWrapper.classList.remove('fix-shadow')
            }
            // 因为缩进了2px
            if (scrollLeft + 2 === _this.$refs.fixedleftWrapper.offsetWidth + _this.$refs.fixedleftWrapper.offsetWidth) {
                _this.$refs.fixedrightWrapper.classList.remove('fix-shadow')
            } else {
                _this.$refs.fixedrightWrapper.classList.add('fix-shadow')
            }
            _this.$refs.fixedleftThead.style.transform = `translateY(${scrollTop}px)`
            _this.$refs.fixedleftWrapper.style.left = `${scrollLeft}px`

            _this.$refs.fixedrightThead.style.transform = `translateY(${scrollTop}px)`
            _this.$refs.fixedrightWrapper.style.right = `-${scrollLeft}px`
        })
    },
}
</script>

<style>
</style>
